var e;!function(e,t){void 0===t&&(t={});var i=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css","top"===i&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}("body.slide-tuning--active{cursor:none}.slide-tuning.slide-tuning--horizontal{cursor:ew-resize}.slide-tuning.slide-tuning--vertical{cursor:ns-resize}.slide-tuning.slide-tuning--active{user-select:none}"),function(e){e.VERTICAL="vertical",e.HORIZONTAL="horizontal"}(e||(e={}));class t extends EventTarget{constructor(t){var i;super(),this.lastPoint=null,this.previewValue=null,this.onPointerUp=this.onPointerUp.bind(this),this.onPointerDown=this.onPointerDown.bind(this),this.onDocumentKeyDown=this.onDocumentKeyDown.bind(this),this.onDocumentContextMenu=this.onDocumentContextMenu.bind(this),this.onDocumentPointerMove=this.onDocumentPointerMove.bind(this),t.step=null!==(i=t.step)&&void 0!==i?i:{default:1,withAlt:.1,withCtrl:100,withShift:10},this.options=Object.assign({direction:e.HORIZONTAL,sensitivity:10,fractionDigits:2},t),this.init()}get element(){return this.options.element}destroy(){this.element.classList.remove("slide-tuning",`slide-tuning--${this.options.direction}`)}init(){this.element.classList.add("slide-tuning",`slide-tuning--${this.options.direction}`),this.element.addEventListener("pointerdown",this.onPointerDown),this.renderer(this.options.value)}renderer(e=this.previewValue){this.options.renderer?this.options.renderer.call(this,e,this.element,this.options):this.element.innerHTML=`${e.toFixed(this.options.fractionDigits)}`}onPointerDown(e){1===e.buttons&&(this.lastPoint={x:e.clientX,y:e.clientY},this.previewValue=this.options.value,this.element.classList.add("slide-tuning--active"),document.body.classList.add("slide-tuning--active"),document.addEventListener("pointermove",this.onDocumentPointerMove),document.addEventListener("contextmenu",this.onDocumentContextMenu,{once:!0}),document.addEventListener("pointerup",this.onPointerUp,{once:!0}),document.addEventListener("keydown",this.onDocumentKeyDown))}onDocumentPointerMove(t){let i;const{clientX:n,clientY:s}=t;switch(this.options.direction){case e.HORIZONTAL:i=n-this.lastPoint.x;break;case e.VERTICAL:i=s-this.lastPoint.y;break;default:throw new Error(`unknown direction: ${this.options.direction}`)}const o=this.getPreviewValue(i,t);this.previewValue!==o&&(this.previewValue=o,this.lastPoint={x:n,y:s},this.renderer(),this.dispatchEvent(new CustomEvent("change",{detail:{value:Number.parseFloat(this.previewValue.toFixed(this.options.fractionDigits))}})))}onPointerUp(e){this.options.value=this.previewValue,this.reset(),this.dispatchEvent(new CustomEvent("changed",{detail:{value:this.options.value}}))}onDocumentContextMenu(e){e.preventDefault(),e.stopPropagation(),this.cancel()}onDocumentKeyDown(e){"Escape"===e.code&&(e.stopImmediatePropagation(),this.cancel())}getPreviewValue(e,t){const{sensitivity:i,step:n}=this.options,{default:s,withAlt:o,withCtrl:r,withShift:l}=n;return t.altKey&&o?this.previewValue+(e/i|0)*o:t.ctrlKey&&r?this.previewValue+(e/i|0)*r:t.shiftKey&&l?this.previewValue+(e/i|0)*l:this.previewValue+(e/i|0)*s}cancel(){this.reset(),this.renderer(this.options.value),this.dispatchEvent(new CustomEvent("cancel",{detail:{value:this.options.value}}))}reset(){this.element.classList.remove("slide-tuning--active"),document.body.classList.remove("slide-tuning--active"),document.removeEventListener("keydown",this.onDocumentKeyDown),document.removeEventListener("pointerup",this.onPointerUp),document.removeEventListener("contextmenu",this.onDocumentContextMenu),document.removeEventListener("pointermove",this.onDocumentPointerMove),this.lastPoint=null,this.previewValue=null}}export{t as SlideTuning,e as SlideTuningDirection};
