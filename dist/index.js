!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).SlideTuning={})}(this,(function(e){"use strict";var t;!function(e,t){void 0===t&&(t={});var i=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===i&&n.firstChild?n.insertBefore(o,n.firstChild):n.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}("body.slide-tuning--active{cursor:none}.slide-tuning.slide-tuning--horizontal{cursor:ew-resize}.slide-tuning.slide-tuning--vertical{cursor:ns-resize}.slide-tuning.slide-tuning--active{user-select:none}"),e.SlideTuningDirection=void 0,(t=e.SlideTuningDirection||(e.SlideTuningDirection={})).VERTICAL="vertical",t.HORIZONTAL="horizontal";class i extends EventTarget{constructor(t){var i;super(),this.lastPoint=null,this.previewValue=null,this.onPointerUp=this.onPointerUp.bind(this),this.onPointerDown=this.onPointerDown.bind(this),this.onDocumentKeyDown=this.onDocumentKeyDown.bind(this),this.onDocumentContextMenu=this.onDocumentContextMenu.bind(this),this.onDocumentPointerMove=this.onDocumentPointerMove.bind(this),t.step=null!==(i=t.step)&&void 0!==i?i:{default:1,withAlt:.1,withCtrl:100,withShift:10},this.options=Object.assign({direction:e.SlideTuningDirection.HORIZONTAL,sensitivity:10,fractionDigits:2},t),this.init()}get element(){return this.options.element}destroy(){this.element.classList.remove("slide-tuning",`slide-tuning--${this.options.direction}`)}init(){this.element.classList.add("slide-tuning",`slide-tuning--${this.options.direction}`),this.element.addEventListener("pointerdown",this.onPointerDown),this.renderer(this.options.value)}renderer(e=this.previewValue){this.options.renderer?this.options.renderer.call(this,e,this.element,this.options):this.element.innerHTML=`${e.toFixed(this.options.fractionDigits)}`}onPointerDown(e){1===e.buttons&&(this.lastPoint={x:e.clientX,y:e.clientY},this.previewValue=this.options.value,this.element.classList.add("slide-tuning--active"),document.body.classList.add("slide-tuning--active"),document.addEventListener("pointermove",this.onDocumentPointerMove),document.addEventListener("contextmenu",this.onDocumentContextMenu,{once:!0}),document.addEventListener("pointerup",this.onPointerUp,{once:!0}),document.addEventListener("keydown",this.onDocumentKeyDown))}onDocumentPointerMove(t){let i;const{clientX:n,clientY:o}=t;switch(this.options.direction){case e.SlideTuningDirection.HORIZONTAL:i=n-this.lastPoint.x;break;case e.SlideTuningDirection.VERTICAL:i=o-this.lastPoint.y;break;default:throw new Error(`unknown direction: ${this.options.direction}`)}const s=this.getPreviewValue(i,t);this.previewValue!==s&&(this.previewValue=s,this.lastPoint={x:n,y:o},this.renderer(),this.dispatchEvent(new CustomEvent("change",{detail:{value:Number.parseFloat(this.previewValue.toFixed(this.options.fractionDigits))}})))}onPointerUp(e){this.options.value=this.previewValue,this.reset(),this.dispatchEvent(new CustomEvent("changed",{detail:{value:this.options.value}}))}onDocumentContextMenu(e){e.preventDefault(),e.stopPropagation(),this.cancel()}onDocumentKeyDown(e){"Escape"===e.code&&(e.stopImmediatePropagation(),this.cancel())}getPreviewValue(e,t){const{sensitivity:i,step:n}=this.options,{default:o,withAlt:s,withCtrl:r,withShift:l}=n;return t.altKey&&s?this.previewValue+(e/i|0)*s:t.ctrlKey&&r?this.previewValue+(e/i|0)*r:t.shiftKey&&l?this.previewValue+(e/i|0)*l:this.previewValue+(e/i|0)*o}cancel(){this.reset(),this.renderer(this.options.value),this.dispatchEvent(new CustomEvent("cancel",{detail:{value:this.options.value}}))}reset(){this.element.classList.remove("slide-tuning--active"),document.body.classList.remove("slide-tuning--active"),document.removeEventListener("keydown",this.onDocumentKeyDown),document.removeEventListener("pointerup",this.onPointerUp),document.removeEventListener("contextmenu",this.onDocumentContextMenu),document.removeEventListener("pointermove",this.onDocumentPointerMove),this.lastPoint=null,this.previewValue=null}}e.SlideTuning=i,Object.defineProperty(e,"__esModule",{value:!0})}));
